
<script>
  function initMap() {
    let center = {lat: 0.000, lng: 0.000};

    let disasters = [];
    <% @disasters.each do |disaster| %>
      disasters.push({lat: <%= disaster.latitude %>, lng: <%= disaster.longitude %>})
    <% end %>

    let map = new google.maps.Map(document.getElementById("map"), {
      zoom: 1,
      center: center
    });
  
    disasters.forEach(disaster => {
      let marker = new google.maps.Marker({
        position: disaster,
        map: map
      });
      attachMarkerInfo(marker, 'click here!')
    });
  };

  function attachMarkerInfo(marker, disaster) {
    var infowindow = new google.maps.InfoWindow({
      content: disaster
    });
    marker.addListener('click', function() {
      infowindow.open(marker.get('map'), marker);
    });
  }
</script>
